"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5160],{54916:(e,n,o)=>{o.d(n,{cp:()=>l});var i=o(45072),t=(o(11504),o(95788)),s=o(54628);const a={toc:[]},r="wrapper";function l(e){let{components:n,...o}=e;return(0,t.yg)(r,(0,i.c)({},a,o,{components:n,mdxType:"MDXLayout"}),(0,t.yg)("p",null,"You can define the ",(0,t.yg)("code",null,o.sectionName)," config section in two ways: ",(0,t.yg)("i",null,"globally")," and ",(0,t.yg)("i",null,"locally")," (per a configuration):"),(0,t.yg)(s.c,{title:".detoxrc.js",language:"javascript",mdxType:"CodeBlock"},["/** @type {Detox.DetoxConfig} */","module.exports = {","// highlight-start",`  ${o.sectionName}: {`,"    /* global section */","  },","// highlight-end","  devices: { /* \u2026 */ },","  apps: { /* \u2026 */ },","  configurations: {","    'ios.sim.debug': {","      device: 'iphone',","      app: 'ios.debug',","// highlight-start",`      ${o.sectionName}: {`,"        /* local (per-configuration) section */","      },","// highlight-end","    },","  },","};"].join("\n")))}l.isMDXComponent=!0},97024:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var i=o(45072),t=(o(11504),o(95788)),s=o(54916);const a={},r="Session",l={unversionedId:"config/session",id:"version-20.x/config/session",title:"Session",description:"It is not recommended to customize this section unless you are debugging native code",source:"@site/versioned_docs/version-20.x/config/session.mdx",sourceDirName:"config",slug:"/config/session",permalink:"/Detox/docs/config/session",draft:!1,editUrl:"https://github.com/wix/Detox/edit/master/docs/versioned_docs/version-20.x/config/session.mdx",tags:[],version:"20.x",frontMatter:{},sidebar:"apiSidebar",previous:{title:"Logger",permalink:"/Detox/docs/config/logger"},next:{title:"Test runner",permalink:"/Detox/docs/config/testRunner"}},d={},p=[{value:"Location",id:"location",level:2},{value:"Properties",id:"properties",level:2},{value:"<code>session.server</code> [string]",id:"sessionserver-string",level:3},{value:"<code>session.sessionId</code> [string]",id:"sessionsessionid-string",level:3},{value:"<code>session.autoStart</code> [boolean]",id:"sessionautostart-boolean",level:3},{value:"<code>session.debugSynchronization</code> [number]",id:"sessiondebugsynchronization-number",level:3}],g={toc:p},c="wrapper";function u(e){let{components:n,...o}=e;return(0,t.yg)(c,(0,i.c)({},g,o,{components:n,mdxType:"MDXLayout"}),(0,t.yg)("h1",{id:"session"},"Session"),(0,t.yg)("admonition",{title:"Note",type:"info"},(0,t.yg)("p",{parentName:"admonition"},"It is not recommended to customize this section unless ",(0,t.yg)("a",{parentName:"p",href:"/Detox/docs/introduction/debugging"},"you are debugging native code"),"\nor contributing to the native iOS/Android code of Detox.")),(0,t.yg)("p",null,"The ",(0,t.yg)("inlineCode",{parentName:"p"},"session")," section tells Detox how to set up its web socket server and client. They are used to forward the JSON-serialized expectations and element interactions to the native implementation of Detox side-loaded with the app."),(0,t.yg)("h2",{id:"location"},"Location"),(0,t.yg)(s.cp,{sectionName:"session",mdxType:"Location"}),(0,t.yg)("h2",{id:"properties"},"Properties"),(0,t.yg)("p",null,"There is one important thing to note when you\u2019ll be defining a session config, e.g.:"),(0,t.yg)("h3",{id:"sessionserver-string"},(0,t.yg)("inlineCode",{parentName:"h3"},"session.server")," ","[","string]"),(0,t.yg)("p",null,"Default: ",(0,t.yg)("inlineCode",{parentName:"p"},"ws://localhost:{randomPort}"),"."),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "session": {\n// highlight-next-line\n    "server": "ws://localhost:8099"\n  }\n}\n')),(0,t.yg)("p",null,"When you define a URL for ",(0,t.yg)("inlineCode",{parentName:"p"},"server"),", it automatically sets ",(0,t.yg)("a",{parentName:"p",href:"#sessionautostart-boolean"},(0,t.yg)("inlineCode",{parentName:"a"},"session.autoStart"))," to ",(0,t.yg)("em",{parentName:"p"},"false")," (mainly due to backward compatibility reasons), so make sure to override it back if you didn\u2019t intend that."),(0,t.yg)("h3",{id:"sessionsessionid-string"},(0,t.yg)("inlineCode",{parentName:"h3"},"session.sessionId")," ","[","string]"),(0,t.yg)("p",null,"Default: a random UUID, e.g. ",(0,t.yg)("inlineCode",{parentName:"p"},"7731871e-2f07-46bb-acbc-cb0eb6a0ace7"),"."),(0,t.yg)("p",null,"Since the Detox server is a single entity, but there can be multiple test workers running multiple devices and apps,\nit needs to understand which connection belongs to which app."),(0,t.yg)("p",null,"Detox forwards ",(0,t.yg)("inlineCode",{parentName:"p"},"sessionId")," to the app as a launch argument, so the app immediately knows where to connect to."),(0,t.yg)("admonition",{type:"caution"},(0,t.yg)("p",{parentName:"admonition"},"Defining an explicit ",(0,t.yg)("inlineCode",{parentName:"p"},"sessionId")," means you cannot use ",(0,t.yg)("strong",{parentName:"p"},"multiple workers"),",\nsince the specified session will become busy for any test worker next to the first one to occupy it."),(0,t.yg)("pre",{parentName:"admonition"},(0,t.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "session": {\n    "server": "ws://localhost:8099",\n// highlight-next-line\n    "sessionId": "YourProjectSessionId"\n  }\n}\n'))),(0,t.yg)("h3",{id:"sessionautostart-boolean"},(0,t.yg)("inlineCode",{parentName:"h3"},"session.autoStart")," ","[","boolean]"),(0,t.yg)("p",null,"Default: ",(0,t.yg)("inlineCode",{parentName:"p"},"true")," for undefined ",(0,t.yg)("inlineCode",{parentName:"p"},"session.server"),", and ",(0,t.yg)("inlineCode",{parentName:"p"},"false")," for defined."),(0,t.yg)("p",null,"Controls whether Detox web socket server will be starting automatically.\nIf ",(0,t.yg)("inlineCode",{parentName:"p"},"false"),", it is assumed that you will be running it independently via ",(0,t.yg)("a",{parentName:"p",href:"/Detox/docs/cli/run-server"},(0,t.yg)("inlineCode",{parentName:"a"},"detox run-server"))," CLI command."),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-diff"},'   "session": {\n+    "autoStart": true,\n     "server": "ws://localhost:8099",\n     "sessionId": "YourProjectSessionId"\n')),(0,t.yg)("h3",{id:"sessiondebugsynchronization-number"},(0,t.yg)("inlineCode",{parentName:"h3"},"session.debugSynchronization")," ","[","number]"),(0,t.yg)("p",null,"Default: ",(0,t.yg)("inlineCode",{parentName:"p"},"10000"),"."),(0,t.yg)("p",null,"Tells Detox how long (in milliseconds) to wait for the app to become idle until it starts querying it for more details."),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "session": {\n    "debugSynchronization": 20000\n  }\n}\n')),(0,t.yg)("p",null,"Detox will be printing the list of busy idling resources every time an action takes more than the specified period, e.g.:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-plain",metastring:"text",text:!0},'15:13:07.309 detox[17005] i The app is busy with the following tasks:\n\u2022 There are 10 work items pending on the dispatch queue: "Main Queue (<OS_dispatch_queue_main: com.apple.main-thread>)".\n\u2022 UI elements are busy:\n  - Layers pending animations: 96.\n  - Layers needs layout: 173.\n  - View needs layout: 74.\n  - View needs display: 98.\n  - Layers needs display: 90.\n\u2022 Run loop "Main Run Loop" is awake.\n')),(0,t.yg)("p",null,"To disable this behavior (i.e. querying the app periodically), set the value to ",(0,t.yg)("inlineCode",{parentName:"p"},"0"),"."),(0,t.yg)("p",null,"Seeing logs like these usually indicates certain issues in your application, as mentioned in the ",(0,t.yg)("a",{parentName:"p",href:"/Detox/docs/troubleshooting/synchronization"},"Troubleshooting Guide"),"."),(0,t.yg)("p",null,"For the most detailed information, refer to the DetoxSync (iOS) ",(0,t.yg)("a",{parentName:"p",href:"https://github.com/wix-incubator/DetoxSync/blob/master/StatusDocumentation.md"},"Status Documentation"),"."))}u.isMDXComponent=!0}}]);